---
title: "cleaning for camera data set"
output: 
  github_document:
    fig_width: 14
    fig_height: 10
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  fig.path = "nb_figs/clean_"
)
```



## purpose of notebook

  - [x] initial look at data to get a basic understanding and gather todos -> df_raw
  - [ ] tidy up and cleaning of data set -> df
  - [ ] all processing of the data set happens here and is saved to pre-/processed csv-> df
 

## observations

  - column information:  
  
  |  # | Attribute | Description |                                                                                               
  |:--:|:---------:|:-----------------------------------------------------------:|
  | 1 | Model | brand and model of the camera, chr, unique, can serve as identifier |
  | 2 | Release date | release date of camera, time series, ordered, numerical |
  | 3 | Max resolution | numerical, metric in number of pixel columns (width), maximal image resolution |
  | 4 | Low resolution | numerical, metric in number of pixel columns (width), standard image resolution |
  | 5 | Effective pixels | numerical, metric in megapixels, arbitrarily rounded, count of image pixel contributing to the final image |
  | 6 | Zoom wide (W) | numerical, metric in mm, focal lengths that create a wide field of view beyond 35mm  |
  | 7 | Zoom tele (T) | numerical, metric in mm, focal lengths that create a narrow field of view beyond 80mm |  
  | 8 | Normal focus range | numerical, metric in mm, minimum distance at which focus can be obtained, feature of lense |  
  | 9 | Macro focus range | numerical, metric in mm, reduced focus range (or working range) to focus on close objects |  
  | 10 | Storage included | numerical, metric in megabyte, storage of included SD-card |  
  | 11 | Weight (inc. batteries) | numerical, metric in g, weight of the camera including batteries |  
  | 12 | Dimensions | numerical, metric in mm, width of the camera dimensions |  
  | 13 | Price | numerical, metric in unknown currency, price when released |  
  
  - missing values are in rows 346 and 347, we will just drop them, since there is no need for the data set to be complete (actually it is incomplete by nature), and there are still       enough observations, also they seem to be missing at random 
  - no duplicated rows
  - no changes were made to data set
  - added a variable which gives the percentage of the sup_waste from the produced polymers
               

## load packages

```{r load packages, setup, message=FALSE}
library(tidyverse) # tidy data frame
library(lubridate) # functions to work with date-times and time-spans
library(scrubr) # like dplyr but specifically for occurrence data
```


## import data

```{r}
df_raw <- read_csv(file = '../data/camera_dataset.csv')
df <- df_raw
```


## first look at data

```{r}
head(df_raw, 25)
```
```{r}
tail(df_raw)
```
```{r}
summary(df_raw)
```


## missing values

missing values are in rows 346 and 347, we will just drop them, since there is no need for the dataset to be complete (actually it is incomplete by nature), and there are still enough observations, also they seem to be missing at random 

```{r}
#create data frame with information on whether the value in each cell is missing
missing_by_column <- df_raw %>%
  is.na %>% # check is each cell is na
  as_tibble %>% # convert to data frame
  mutate(row_number = 1:nrow(.)) %>% # add a column with the row number
  gather(variable, is_missing, -row_number) # turn wide data into narrow data

# plot the missing values in our data frame
ggplot(missing_by_column, aes(x = variable, y = row_number, fill =  is_missing)) +
  geom_tile() +
  theme_minimal() +
  scale_fill_grey(name = "",
                  labels = c("present", "missing")) +
  theme(axis.text.x = element_text(angle=45, vjust=0.7, size=8)) +
  labs(x = "vairables in dataset",
       y = "rows / observations")
```
```{r}
# drop the rows with missing values 
df <- df[-c(346, 347), ]
```


## duplicated rows

no duplicated rows

```{r}
# get row number of duplicated rows
duplicated_rows = tibble(duplicated = duplicated(df_raw), row = 1:nrow(df_raw)) %>%
  filter(duplicated == T)

# plot duplicated rows as black lines
ggplot(duplicated_rows, aes(xintercept = row)) +
  geom_vline(aes(xintercept = row)) + # plot a black line for each duplicated row
  ggtitle("indexes of duplicated rows") + # add title
  coord_flip() + # flip x and y axis
  scale_x_reverse() # reverse x axis
```


## cleaning

nothing to clean

```{r}

```


## additional variables

we can get the producer from the model name

```{r}

```


## save processed data

```{r}
write_csv(df, file = '../data/camera_dataset_processed.csv')
```

